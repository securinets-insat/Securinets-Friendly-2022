from factordb.factordb import FactorDB
from Crypto.Util.number import long_to_bytes,inverse

pubkey= 54786796181661639481407630909488357105745782329661034455381345419360606712843793751764798647774766371960132895515386985587780873155439823958235448968540277639415645754486008509143022178283707254409446933437209278362958392360382235050321140937486214125567826635007071213864397850554926189560722085081924423661630355529662673543637792044920988908813413499926199453975407952406435361868143751489561990894201412623537535345822395131468612030888392577334448688720421121542378905323930343434556847281518072805631950482141538714869093751449842405703447528178254285071999147809196158631046246418900489471966657856487184939045173834376518581125812433329753126802631478663975329178182683529953155755075296519735954392889997891163102728868470053131758482408294972609354387768391963199298635937837230779809253650275649339143186698421597207649130923787983990840550482891941356508689173071966880946819403755840404425733159455487688591833691036434396911849731805048830704948263895049118612212058597731022490519566673573922966614669307367053491842323535234985216881083485656279085310998089064686384072628535450203697900572667815885885276027552534622163706704955801857186020122374327656944514755003476660397528087870211360044062507396762567133419005900318343495277610352917834150895014078508840440579683249477137838133336844893363044744419850577852435279690695405033223442478500102748178115915327995240436170825637284628025027342237931425425653354776437766724455277859665127530159758645736705370887231131889693057495175395012423645294236362227190474456581510650802378273473006556189491161147375327822359279890566115416855035601505965701453425877756832277844487018655516565471149355520806028814651029946358221361028153252975945575358768390601179985756570483713763186747216803489335568957630641583127230328488601
exponent= 65537
ciphertext= 1944591246368475530649467537731570917522291725503898824068799322554430823477045001784233644032009268718022377083570496735485022265789035702640284816722566799155282637293569223067546860135441437521884741562684701666490876865116420163957603973930443653088387472647424798929108760184407308765645808721959253290161383229107663156724771922980384362789958114407811250812353452512488708635616431156771327642402038212896518639159029249581747899799638289704504329877459890356714818786186041456962664178889727503194904642739046844102120212170485767662229787825922185689978946499934966516214918780661479545882394397411818895946236180992370443401820087498792121332282980475673888449883502962667939442881639795022866065469259567607006325849289079461243070508310207017810679047002462066012729539593029467129455152475765140881628600515209420613206573774236103382004621650275888308053513641925009087547007286115282090878202590773013465625153161673104636831001522234085626489427857936933138882032467291285055682046800601123890630761471378810011287793777433771313975447959980641170635169365321068067560794185090503004028365039934031584128483997962355789450524557396937289290629282044011085256074921791786601267554508500632439385967982145304866118797130596110813240980031292179046939453628812206729525504259394975871031446082410378368919886720903507118175834034130408409092350512582035542165216610497706478562942430262085192419211259476071016987221626146533065701233921780661834558213255943515654195848419569139905231506877483193191836360829865844357365381813563736339876733139823401348243974604049260844172964925695546560066524837442314091691540935258113597891052711945264943663672153077604770017635622212718253201018864210477327607715244025086969990878592484369160885601944421666558900242610395162278273929430
fac_api=FactorDB(pubkey)
fac_api.connect()
factor_list=fac_api.get_factor_from_api()
factor_list=[[int(i[0]),i[1]] for i in factor_list]
def calc_phi(fac_list):
    phi=1
    for i in fac_list:
        phi*=(i[0]**(i[1]-1))*(i[0]-1)
    return phi
phi=calc_phi(factor_list)
d=inverse(exponent,phi)
print(long_to_bytes(pow(ciphertext,d,pubkey)))